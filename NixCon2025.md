---
title: Ricochets
subtitle: \footnotesize Hacking on `<nixos>` default channel for machine herd management, fun and non-profit
author: https://functional.cafe/\@yvan
theme: default
---

## The problem

Non-tech-savvy friends want to switch to Linux\footnote{e.g., because of the EOL of Windows 10}, and they expect their computers to keep working for years\footnote{but I (hopefully) don't want to end up as their technical hotline}.

NixOS is great, **but there's no LTS**, and upgrading to the next stable version often requires writing a bit of Nix code.

## The _magic_ solution

**Use the default NixOS graphical installer\footnote{choose GNOME or KDE, set your language/timezone/keymap, configure full-disk encryption, etc.}.** Then, open a terminal and paste the line that installs Ricochets\footnote{it even includes a user-friendly TUI to help set up NixOS hardware customizations}!

## How does that work?

It keeps the `/etc/nixos/configuration.nix` that was generated but replaces the `<nixos>` channel\footnote{I know Nix channels are a bit cursed} with a custom one\footnote{https://ricochets.stoemp.club/main.tar.gz}.

Please look up the sources at [https://git.sr.ht/~yvan-sraka/ricochets](https://git.sr.ht/~yvan-sraka/ricochets/tree)

## How does it keep working?

I've set up some self-hosted\footnote{bye-bye GitHub Actions, hello IPv6} CI that auto-updates the channel but validates it against some example configs\footnote{using nixos-vm}.

The channel also serves as a placeholder to redefine options that could be deprecated in nixpkg\footnote{recall I don't want the user to have to edit their configuration.nix}, e.g., `sound.enable` in > 24.05, `services.xserver.displayManager` in > 25.05, etc.\footnote{it's not a lot of backporting, not the full release notes, just the options that are used in the configuration.nix generated by the installer}

## Can I do that?

The channel sets different defaults than nixpkgs: AppImage, Flatpaks, `envfs` and `nix-ld`\footnote{and of course, automatic upgrade and garbage-collection}.

So, we got some kind of super handy machine herd management, still without asking users\footnote{or e.g., using some nix-manipulator-based automation} to add a module to their `configuration.nix`.

## Questions?

Feel free to ping me on Mastodon [@yvan@functional.cafe](https://functional.cafe/\@yvan) ;)
